---
layout:     post
title:      小程序体积优化笔记
date:       2022-4-13
author:     呆贝斯
header-img: img/post-bg-rwd.jpg
catalog: true
tags:
    - select
    - poll
    - epoll
---
```
小程序代码包上传阶段限制了主包 2M 和总包 20M 的尺寸，超过就会面临无法发版的风险，代码包体积的优化就变得特别重要了。
```
# 代码分包（将相对独立的页面和组件拆分到分包，可以解决主包体积受限问题）

# 依赖分析（移除未引用的页面、组件和其他文件）

# 避免使用本地资源（除了必要图片，其他尽可能使用 url 的方式）

# 对所有文件进行压缩并清理注释

# 分析编译后每个文件的高频重复代码，提取成公共文件，替换原引用以实现共用

# 字体和颜色的全局共用
    小程序文档内关于继承样式的说明为：继承样式，如font,color, 会从组件外继承到组件内。分析项目现状，
    我们通常会把字体定义放在公共 css 文件内，随着页面或组件引入公共 css，font 也将被重复引入，可以通过改造，
    把 font 的定义仅放在 app.wxss 内，取消组件和页面的引入，可以达到减少整体代码包体积的目的。
    关于这一项首页项目体积减少1%，预估整个项目还有 20kb 左右的 font 定义可清理。
    如果有全局的颜色定义，也可以进行类似的优化。

# 样式补全功能的使用

# 小心 Sass!

# 多端场景的冗余代码移除